<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>バーサスリヴァイズ設定判別</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input { width: 60px; margin: 3px; }
    .section { margin-bottom: 20px; }
    button { margin-top: 10px; }
  </style>
</head>
<body>
  <h1>バーサスリヴァイズ設定判別</h1>

  <div class="section">
    <h3>① 総ゲーム数関連</h3>
    総ゲーム数: <input id="totalGames" type="number" placeholder="例: 5000"><br>
    BIG: <input id="big" type="number">
    REG: <input id="reg" type="number">
    ベルA: <input id="bellA" type="number">
    ベルB: <input id="bellB" type="number">
    スイカA: <input id="suikaA" type="number">
    チェリーB: <input id="cherryB" type="number">
  </div>

  <button onclick="analyze()">判別する</button>
  <button onclick="resetAll()">全データ削除</button>

  <div id="result" class="section"></div>
  <div class="section">
    <a href="index.html">機種検索画面に戻る</a>
  </div>

<script>
function analyze() {
  const total = parseFloat(document.getElementById('totalGames').value);
  const big = parseFloat(document.getElementById('big').value) || 0;
  const reg = parseFloat(document.getElementById('reg').value) || 0;
  const bellA = parseFloat(document.getElementById('bellA').value) || 0;
  const bellB = parseFloat(document.getElementById('bellB').value) || 0;
  const suikaA = parseFloat(document.getElementById('suikaA').value) || 0;
  const cherryB = parseFloat(document.getElementById('cherryB').value) || 0;

  const totalCount = big + reg + bellA + bellB + suikaA + cherryB;
  if (!total || totalCount === 0) {
    document.getElementById('result').innerText = 'データが不十分です';
    return;
  }

  const settings = {
    1: { big: 1/292.6, reg: 1/374.5, bellA: 1/10.9, bellB: 1/20.9, suikaA: 1/74.5, cherryB: 1/56.2 },
    2: { big: 1/284.9, reg: 1/341.3, bellA: 1/10.7, bellB: 1/21.2, suikaA: 1/70.6, cherryB: 1/57.7 },
    5: { big: 1/275.4, reg: 1/319.7, bellA: 1/10.5, bellB: 1/20.3, suikaA: 1/72.5, cherryB: 1/53.1 },
    6: { big: 1/264.3, reg: 1/292.6, bellA: 1/10.2, bellB: 1/20.6, suikaA: 1/68.8, cherryB: 1/54.4 }
  };

  const likelihoods = {};
  for (let s in settings) {
    const p = settings[s];
    const probs = [p.big, p.reg, p.bellA, p.bellB, p.suikaA, p.cherryB];
    const obs = [big, reg, bellA, bellB, suikaA, cherryB];
    let likelihood = factorial(totalCount);
    for (let i = 0; i < obs.length; i++) {
      likelihood *= Math.pow(probs[i], obs[i]) / factorial(obs[i]);
    }
    likelihoods[s] = likelihood;
  }

  const sorted = Object.entries(likelihoods).sort((a, b) => b[1] - a[1]);
  let result = '<h3>判別結果（総ゲーム数ベース）</h3><ol>';
  for (const [s, l] of sorted) {
    result += `<li>設定${s}：${l.toExponential(2)}</li>`;
  }
  result += '</ol>';
  document.getElementById('result').innerHTML = result;
}

function resetAll() {
  document.querySelectorAll('input').forEach(i => i.value = '');
  document.getElementById('result').innerHTML = '';
}

function factorial(n) {
  if (n === 0 || n === 1) return 1;
  let res = 1;
  for (let i = 2; i <= n; i++) res *= i;
  return res;
}
</script>
</body>
</html>