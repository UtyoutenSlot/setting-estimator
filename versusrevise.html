<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¨­å®šåˆ¤åˆ¥ å…¥åŠ›ç”»é¢</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      background-color: #f2f2f2;
    }

      .wrapper {
       width: 100%;
       max-width: 375px;
       margin: 0 auto;
       padding: 0 8px;  /* â† ã‚¹ãƒãƒ›ã§ã‚‚å·¦å³ä½™ç™½ãŒã‚ã‚‹ã‚ˆã†ã« */
       box-sizing: border-box;
    }
       .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(18, 28px);
      gap: 4px;
      margin-bottom: 0;
      overflow: hidden;
    }

    .box {
      background: #fff;
      padding: 8px;
      border-radius: 8px;
      font-size: 12px;
      box-shadow: 0 0 2px rgba(0, 0, 0, 0.2);
    }

    .box h3 {
      margin: 4px 0 8px;
      font-size: 13px;
    }

    .row {
      margin: 8px 0;
    }

    .row label {
      display: block;
      margin-bottom: 4px;
      font-size: 13px;
    }

    .row input[type="number"] {
      width: 80px;
      height: 24px;
      text-align: center;
      border: 1px solid #333;
      border-radius: 4px;
      font-size: 13px;
    }

    /* è‰²åˆ†ã‘ */
    .green { background: #dff3e0; }
    .yellow { background: #fdf8c6; }
    .blue { background: #cce7f9; }
    .pink { background: #f8d7f2; }
    .purple { background: #e5d4f5; }
    .orange { background: #ffe4b5; }

    </style>
</head>
<body>
  <div class="wrapper">
    
    <div class="grid">
      <!-- ãƒœãƒ¼ãƒŠã‚¹ãƒ»å°å½¹ -->
      <div class="box green" style="grid-row: span 16;">
        <h3>Bonuså°å½¹</h3>
        <div class="row"><label>ç·Gæ•°</label><input type="number"></div>
        <div class="row"><label>BIG</label><input type="number"></div>
        <div class="row"><label>REG</label><input type="number"></div>
        <div class="row"><label>ãƒ™ãƒ«A</label><input type="number"></div>
        <div class="row"><label>ãƒ™ãƒ«B</label><input type="number"></div>
        <div class="row"><label>ã‚¹ã‚¤ã‚«A</label><input type="number"></div>
        <div class="row"><label>ãƒã‚§ãƒªãƒ¼B</label><input type="number"></div>
      </div>

      <!-- BIGä¸­ -->
<div class="box yellow" style="grid-row: span 9;">
  <h3>BIGä¸­</h3>
  <div class="row"><label>ç·Gæ•°</label><input id="bigTotal" type="number"></div>
  <div class="row"><label>è§’ãƒã‚§ãƒ™ãƒ«</label><input id="kakubell" type="number"></div>
  <div class="row"><label>è§’ãƒã‚§</label><input id="kakuke" type="number"></div>
  <div class="row"><label>ä¸­æ®µãƒã‚§</label><input id="chudan" type="number"></div>
</div>

      <!-- REGä¸­ -->
      <div class="box blue" style="grid-row: span 9;">
        <h3>REGä¸­</h3>
        <div class="row"><label>ç·Gæ•°</label><input type="number"></div>
        <div class="row"><label>ä¸€æšå½¹</label><input type="number"></div>
        <div class="row"><label>ãƒã‚ºãƒ¬</label><input type="number"></div>
      </div>

      <!-- VCä¸­ -->
      <div class="box pink" style="grid-row: span 7;">
        <h3>VCä¸­</h3>
        <div class="row"><label>ç·Gæ•°</label><input type="number"></div>
        <div class="row"><label>é€šå¸¸ãƒªãƒ—</label><input type="number"></div>
        <div class="row"><label>ãƒã‚ºãƒ¬</label><input type="number"></div>
      </div>

      <!-- VGä¸­ -->
      <div class="box purple" style="grid-row: span 7;">
        <h3>VGä¸­</h3>
        <div class="row"><label>ç·Gæ•°</label><input type="number"></div>
        <div class="row"><label>RTãƒªãƒ—</label><input type="number"></div>
        <div class="row"><label>ãƒã‚ºãƒ¬</label><input type="number"></div>
      </div>
    </div>

   <!-- REGçµ‚äº†ç”»é¢ï¼ˆå·¦å³åˆ†å‰²ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰ -->
<div class="box orange" style="margin-top: 0; padding: 8px;">
  <div style="display: flex; gap: 8px;">
    
    <!-- å·¦å´ï¼šå…¥åŠ›æ¬„ -->
    <div style="flex: 1;">
      <div class="row" style="display: flex; align-items: center; gap: 4px; margin-bottom: 6px;">
        <h3 style="margin: 0; font-size: 13px;">REGç”»é¢</h3>
        <label style="font-size: 13px; display: flex; align-items: center; gap: 4px;">
          <input type="checkbox" id="regEndCheck"> èµ¤å¸¯å‡ºç¾
        </label>
      </div>
      <div class="row" style="display: flex; align-items: center; gap: 6px;"><input type="number" style="width: 60px;"><span>1/128</span></div>
      <div class="row" style="display: flex; align-items: center; gap: 6px;"><input type="number" style="width: 60px;"><span>1/32</span></div>
      <div class="row" style="display: flex; align-items: center; gap: 6px;"><input type="number" style="width: 60px;"><span>1/16</span></div>
      <div class="row" style="display: flex; align-items: center; gap: 6px;"><input type="number" style="width: 60px;"><span>1/8</span></div>
      <div class="row" style="display: flex; align-items: center; gap: 6px;"><input type="number" style="width: 60px;"><span>1/5.2</span></div>
      <div class="row" style="display: flex; align-items: center; gap: 6px;"><input type="number" style="width: 60px;"><span>1/4</span></div>
      <div class="row" style="display: flex; align-items: center; gap: 6px;"><input type="number" style="width: 60px;"><span>1/2</span></div>
    </div>

   <!-- å³å´ï¼šæ³¨æ„æ›¸ãï¼‹è¡¨ï¼ˆç¸¦ã«ä¸¦ã¹ã¦ä¸‹è©°ã‚ï¼‰ -->
<div style="flex: 1; display: flex; flex-direction: column; justify-content: flex-end;">
  <div style="font-size: 10px; line-height: 1.4; margin-bottom: 4px;">
    <p style="margin: 2px 0;">â€»èµ¤å¸¯å‡ºç¾æ™‚ã¯ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚</p>
    <p style="margin: 2px 0;">â€»ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚ŒãŸå ´åˆã¯REGå›æ•°ã®å…¥åŠ›ã¯ä¸è¦ã§ã™ã€‚</p>
    <p style="margin: 2px 0;">
      â€»èµ¤å¸¯ãŒå‡ºç¾ã—ã¦ã„ãªã„å ´åˆã€ä¸‹è¨˜ã®è¡¨ã‚’å‚è€ƒã« <strong>èµ¤å¸¯ãŒå‡ºãªã‹ã£ãŸ REG</strong> ã®å›æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
    </p>
  </div>

  <table style="font-size: 10px; width: 100%; border-collapse: collapse; text-align: center;">
    <thead>
      <tr style="background: #f5f5f5;">
        <th style="border: 1px solid #ccc; padding: 2px;">ï¼‘æšå½¹ï¼¼RTé€£</th>
        <th style="border: 1px solid #ccc; padding: 2px;">ç„¡</th>
        <th style="border: 1px solid #ccc; padding: 2px;">2</th>
        <th style="border: 1px solid #ccc; padding: 2px;">3+</th>
      </tr>
    </thead>
    <tbody>
      <tr><td style="border: 1px solid #ccc;">1å›ä»¥ä¸‹</td><td>1/128</td><td>1/32</td><td>1/16</td></tr>
      <tr><td style="border: 1px solid #ccc;">2å›</td><td>1/32</td><td>1/16</td><td>1/8</td></tr>
      <tr><td style="border: 1px solid #ccc;">3å›</td><td>1/16</td><td>1/8</td><td>1/5.2</td></tr>
      <tr><td style="border: 1px solid #ccc;">4å›</td><td>1/8</td><td>1/4</td><td>1/4</td></tr>
      <tr><td style="border: 1px solid #ccc;">5å›ä»¥ä¸Š</td><td>1/4</td><td>1/2</td><td><strong>1/2</strong></td></tr>
    </tbody>
  </table>
</div>

  </div>
</div>

<!-- åˆ¤åˆ¥ãƒœã‚¿ãƒ³ -->
<div style="margin-top: 24px;">
  <button onclick="showResult()" style="font-size: 16px; padding: 8px 16px;">åˆ¤åˆ¥ã™ã‚‹</button>
</div>

<!-- åˆ¤åˆ¥çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
<div id="resultArea" style="display: none; margin-top: 20px;">
  <!-- åˆ¤åˆ¥çµæœè¡¨ -->
  <table style="font-size: 12px; width: 100%; border-collapse: collapse; margin-bottom: 16px;">
    <thead>
      <tr style="background: #eee;">
        <th style="border: 1px solid #ccc; padding: 4px;">è¨­å®šï¼¼åŒºé–“</th>
        <th style="border: 1px solid #ccc; padding: 4px;"><strong>ç·åˆè©•ä¾¡</strong></th>
        <th style="border: 1px solid #ccc; padding: 4px;">ãƒœãƒ¼ãƒŠã‚¹å°å½¹</th>
        <th style="border: 1px solid #ccc; padding: 4px;">BIGä¸­</th>
        <th style="border: 1px solid #ccc; padding: 4px;">REGä¸­</th>
        <th style="border: 1px solid #ccc; padding: 4px;">VCä¸­</th>
        <th style="border: 1px solid #ccc; padding: 4px;">VGä¸­</th>
        <th style="border: 1px solid #ccc; padding: 4px;">REGç”»é¢</th>
      </tr>
    </thead>
    <tbody>
      <tr><td style="border: 1px solid #ccc;">è¨­å®š1</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td></tr>
      <tr><td style="border: 1px solid #ccc;">è¨­å®š2</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td></tr>
      <tr><td style="border: 1px solid #ccc;">è¨­å®š5</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td></tr>
      <tr><td style="border: 1px solid #ccc;">è¨­å®š6</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td><td>--%</td></tr>
    </tbody>
  </table>

  <!-- åˆ¤åˆ¥çµæœä¸‹ã®å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
  <div style="margin-top: 20px;">
  <div style="display: flex; flex-wrap: wrap; gap: 8px;">
    <div style="flex: 1 1 100px;">
      <label style="font-size: 13px;">æ—¥ä»˜</label>
      <input type="date" style="width: 100%;">
    </div>
    <div style="flex: 1 1 100px;">
      <label style="font-size: 13px;">å°ç•ª</label>
      <input type="text" style="width: 100%;">
    </div>
    <div style="flex: 1 1 100px;">
      <label style="font-size: 13px;">åº—èˆ—å</label>
      <input type="text" style="width: 100%;">
    </div>
  </div>

  <div style="margin-top: 12px;">
    <label style="font-size: 13px;">ãƒ¡ãƒ¢</label><br>
    <textarea rows="3" style="width: 100%; font-size: 13px;"></textarea>
  </div>

  <div style="margin-top: 12px; text-align: left;">
    <button style="font-size: 14px;">ğŸ“¸ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ç”Ÿæˆ</button>
  </div>
</div>

<script>
  function logFact(n) {
    if (n === 0 || n === 1) return 0;
    let res = 0;
    for (let i = 2; i <= n; i++) res += Math.log(i);
    return res;
  }

  function binomialLogP(k, n, p) {
    if (k > n || p <= 0 || p >= 1) return -Infinity;
    return logFact(n) - logFact(k) - logFact(n - k) + k * Math.log(p) + (n - k) * Math.log(1 - p);
  }

  function showResult() {
    document.getElementById("resultArea").style.display = "block";

    // ğŸŸ¡ BIGä¸­ã®åˆ¤åˆ¥å‡¦ç†
    const bigTotal = parseInt(document.getElementById("bigTotal").value || 0);
    const kakubell = parseInt(document.getElementById("kakubell").value || 0);
    const kakuke   = parseInt(document.getElementById("kakuke").value || 0);
    const chudan   = parseInt(document.getElementById("chudan").value || 0);

    const rates = {
      kakubell: [1/11.1, 1/8.9, 1/11.1, 1/8.9],
      kakuke:   [1/256.0, 1/128.0, 1/256.0, 1/128.0],
      chudan:   [1/16384, 1/16384, 1/16384, 1/897.8],
    };

    const logs = [0, 0, 0, 0];
    const keys = ['kakubell', 'kakuke', 'chudan'];
    const counts = [kakubell, kakuke, chudan];

    keys.forEach((key, i) => {
      for (let s = 0; s < 4; s++) {
        logs[s] += binomialLogP(counts[i], bigTotal, rates[key][s]);
      }
    });

    // æ­£è¦åŒ–ã—ã¦%åŒ–
    const maxLog = Math.max(...logs);
    const expLogs = logs.map(l => Math.exp(l - maxLog));
    const total = expLogs.reduce((a, b) => a + b);
    const percents = expLogs.map(v => (v / total * 100).toFixed(2) + "%");

    // è¡¨ã«åæ˜ ï¼ˆBIGä¸­åˆ—: 3åˆ—ç›® = index 3ï¼‰
    const rows = document.querySelectorAll("#resultArea tbody tr");
    rows.forEach((tr, i) => {
      tr.children[3].innerText = percents[i]; // 3åˆ—ç›®ãŒBIGä¸­
    });

    // æ—¥ä»˜ã®åˆæœŸå€¤è¨­å®šï¼ˆ1å›ã ã‘ã§è‰¯ã„å‡¦ç†ï¼‰
    const dateField = document.getElementById("dateInput");
    if (dateField && !dateField.value) {
      const today = new Date().toISOString().split("T")[0];
      dateField.value = today;
    }
  }
</script>
  </div>

  <div style="text-align: center; margin-top: 20px;">
  <a href="index.html">ï¼œ æ©Ÿç¨®é¸æŠã«æˆ»ã‚‹</a>
</div>
  </div>

</body>
</html>